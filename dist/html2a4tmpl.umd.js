(function(w,I){typeof exports=="object"&&typeof module<"u"?module.exports=I():typeof define=="function"&&define.amd?define(I):(w=typeof globalThis<"u"?globalThis:w||self,w.html2a4tmpl=I())})(this,function(){"use strict";const w=document,I=window,ct=w.documentElement,v=w.createElement.bind(w),ut=v("div"),Y=v("table"),Bt=v("tbody"),lt=v("tr"),{isArray:z,prototype:ft}=Array,{concat:Mt,filter:G,indexOf:dt,map:ht,push:Pt,slice:pt,some:X,splice:jt}=ft,Lt=/^#(?:[\w-]|\\.|[^\x00-\xa0])*$/,Ft=/^\.(?:[\w-]|\\.|[^\x00-\xa0])*$/,Wt=/<.+>/,zt=/^\w+$/;function K(t,n){const e=qt(n);return!t||!e&&!B(n)&&!m(n)?[]:!e&&Ft.test(t)?n.getElementsByClassName(t.slice(1).replace(/\\/g,"")):!e&&zt.test(t)?n.getElementsByTagName(t):n.querySelectorAll(t)}class q{constructor(n,e){if(!n)return;if(Q(n))return n;let i=n;if(x(n)){const s=e||w;if(i=Lt.test(n)&&B(s)?s.getElementById(n.slice(1).replace(/\\/g,"")):Wt.test(n)?Ct(n):Q(s)?s.find(n):x(s)?r(s).find(n):K(n,s),!i)return}else if(M(n))return this.ready(n);(i.nodeType||i===I)&&(i=[i]),this.length=i.length;for(let s=0,a=this.length;s<a;s++)this[s]=i[s]}init(n,e){return new q(n,e)}}const o=q.prototype,r=o.init;r.fn=r.prototype=o,o.length=0,o.splice=jt,typeof Symbol=="function"&&(o[Symbol.iterator]=ft[Symbol.iterator]);function Q(t){return t instanceof q}function L(t){return!!t&&t===t.window}function B(t){return!!t&&t.nodeType===9}function qt(t){return!!t&&t.nodeType===11}function m(t){return!!t&&t.nodeType===1}function Dt(t){return!!t&&t.nodeType===3}function Ut(t){return typeof t=="boolean"}function M(t){return typeof t=="function"}function x(t){return typeof t=="string"}function T(t){return t===void 0}function F(t){return t===null}function gt(t){return!isNaN(parseFloat(t))&&isFinite(t)}function Z(t){if(typeof t!="object"||t===null)return!1;const n=Object.getPrototypeOf(t);return n===null||n===Object.prototype}r.isWindow=L,r.isFunction=M,r.isArray=z,r.isNumeric=gt,r.isPlainObject=Z;function y(t,n,e){if(e){let i=t.length;for(;i--;)if(n.call(t[i],i,t[i])===!1)return t}else if(Z(t)){const i=Object.keys(t);for(let s=0,a=i.length;s<a;s++){const c=i[s];if(n.call(t[c],c,t[c])===!1)return t}}else for(let i=0,s=t.length;i<s;i++)if(n.call(t[i],i,t[i])===!1)return t;return t}r.each=y,o.each=function(t){return y(this,t)},o.empty=function(){return this.each((t,n)=>{for(;n.firstChild;)n.removeChild(n.firstChild)})};function D(...t){const n=Ut(t[0])?t.shift():!1,e=t.shift(),i=t.length;if(!e)return{};if(!i)return D(n,r,e);for(let s=0;s<i;s++){const a=t[s];for(const c in a)n&&(z(a[c])||Z(a[c]))?((!e[c]||e[c].constructor!==a[c].constructor)&&(e[c]=new a[c].constructor),D(n,e[c],a[c])):e[c]=a[c]}return e}r.extend=D,o.extend=function(t){return D(o,t)};const Vt=/\S+/g;function U(t){return x(t)?t.match(Vt)||[]:[]}o.toggleClass=function(t,n){const e=U(t),i=!T(n);return this.each((s,a)=>{m(a)&&y(e,(c,u)=>{i?n?a.classList.add(u):a.classList.remove(u):a.classList.toggle(u)})})},o.addClass=function(t){return this.toggleClass(t,!0)},o.removeAttr=function(t){const n=U(t);return this.each((e,i)=>{m(i)&&y(n,(s,a)=>{i.removeAttribute(a)})})};function Jt(t,n){if(t){if(x(t)){if(arguments.length<2){if(!this[0]||!m(this[0]))return;const e=this[0].getAttribute(t);return F(e)?void 0:e}return T(n)?this:F(n)?this.removeAttr(t):this.each((e,i)=>{m(i)&&i.setAttribute(t,n)})}for(const e in t)this.attr(e,t[e]);return this}}o.attr=Jt,o.removeClass=function(t){return arguments.length?this.toggleClass(t,!1):this.attr("class","")},o.hasClass=function(t){return!!t&&X.call(this,n=>m(n)&&n.classList.contains(t))},o.get=function(t){return T(t)?pt.call(this):(t=Number(t),this[t<0?t+this.length:t])},o.eq=function(t){return r(this.get(t))},o.first=function(){return this.eq(0)},o.last=function(){return this.eq(-1)};function Yt(t){return T(t)?this.get().map(n=>m(n)||Dt(n)?n.textContent:"").join(""):this.each((n,e)=>{m(e)&&(e.textContent=t)})}o.text=Yt;function _(t,n,e){if(!m(t))return;const i=I.getComputedStyle(t,null);return e?i.getPropertyValue(n)||void 0:i[n]||t.style[n]}function E(t,n){return parseInt(_(t,n),10)||0}function mt(t,n){return E(t,`border${n?"Left":"Top"}Width`)+E(t,`padding${n?"Left":"Top"}`)+E(t,`padding${n?"Right":"Bottom"}`)+E(t,`border${n?"Right":"Bottom"}Width`)}const tt={};function Gt(t){if(tt[t])return tt[t];const n=v(t);w.body.insertBefore(n,null);const e=_(n,"display");return w.body.removeChild(n),tt[t]=e!=="none"?e:"block"}function yt(t){return _(t,"display")==="none"}function bt(t,n){const e=t&&(t.matches||t.webkitMatchesSelector||t.msMatchesSelector);return!!e&&!!n&&e.call(t,n)}function V(t){return x(t)?(n,e)=>bt(e,t):M(t)?t:Q(t)?(n,e)=>t.is(e):t?(n,e)=>e===t:()=>!1}o.filter=function(t){const n=V(t);return r(G.call(this,(e,i)=>n.call(e,i,e)))};function H(t,n){return n?t.filter(n):t}o.detach=function(t){return H(this,t).each((n,e)=>{e.parentNode&&e.parentNode.removeChild(e)}),this};const Xt=/^\s*<(\w+)[^>]*>/,Kt=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,xt={"*":ut,tr:Bt,td:lt,th:lt,thead:Y,tbody:Y,tfoot:Y};function Ct(t){if(!x(t))return[];if(Kt.test(t))return[v(RegExp.$1)];const n=Xt.test(t)&&RegExp.$1,e=xt[n]||xt["*"];return e.innerHTML=t,r(e.childNodes).detach().get()}r.parseHTML=Ct,o.has=function(t){const n=x(t)?(e,i)=>K(t,i).length:(e,i)=>i.contains(t);return this.filter(n)},o.not=function(t){const n=V(t);return this.filter((e,i)=>(!x(t)||m(i))&&!n.call(i,e,i))};function N(t,n,e,i){const s=[],a=M(n),c=i&&V(i);for(let u=0,d=t.length;u<d;u++)if(a){const h=n(t[u]);h.length&&Pt.apply(s,h)}else{let h=t[u][n];for(;h!=null&&!(i&&c(-1,h));)s.push(h),h=e?h[n]:null}return s}function wt(t){return t.multiple&&t.options?N(G.call(t.options,n=>n.selected&&!n.disabled&&!n.parentNode.disabled),"value"):t.value||""}function Qt(t){return arguments.length?this.each((n,e)=>{const i=e.multiple&&e.options;if(i||Ht.test(e.type)){const s=z(t)?ht.call(t,String):F(t)?[]:[String(t)];i?y(e.options,(a,c)=>{c.selected=s.indexOf(c.value)>=0},!0):e.checked=s.indexOf(e.value)>=0}else e.value=T(t)||F(t)?"":t}):this[0]&&wt(this[0])}o.val=Qt,o.is=function(t){const n=V(t);return X.call(this,(e,i)=>n.call(e,i,e))},r.guid=1;function S(t){return t.length>1?G.call(t,(n,e,i)=>dt.call(i,n)===e):t}r.unique=S,o.add=function(t,n){return r(S(this.get().concat(r(t,n).get())))},o.children=function(t){return H(r(S(N(this,n=>n.children))),t)},o.parent=function(t){return H(r(S(N(this,"parentNode"))),t)},o.index=function(t){const n=t?r(t)[0]:this[0],e=t?this:r(n).parent().children();return dt.call(e,n)},o.closest=function(t){const n=this.filter(t);if(n.length)return n;const e=this.parent();return e.length?e.closest(t):n},o.siblings=function(t){return H(r(S(N(this,n=>r(n).parent().children().not(n)))),t)},o.find=function(t){return r(S(N(this,n=>K(t,n))))};const Zt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,tn=/^$|^module$|\/(java|ecma)script/i,nn=["type","src","nonce","noModule"];function en(t,n){const e=r(t);e.filter("script").add(e.find("script")).each((i,s)=>{if(tn.test(s.type)&&ct.contains(s)){const a=v("script");a.text=s.textContent.replace(Zt,""),y(nn,(c,u)=>{s[u]&&(a[u]=s[u])}),n.head.insertBefore(a,null),n.head.removeChild(a)}})}function sn(t,n,e,i,s){i?t.insertBefore(n,e?t.firstChild:null):t.nodeName==="HTML"?t.parentNode.replaceChild(n,t):t.parentNode.insertBefore(n,e?t:t.nextSibling),s&&en(n,t.ownerDocument)}function O(t,n,e,i,s,a,c,u){return y(t,(d,h)=>{y(r(h),(R,k)=>{y(r(n),(f,p)=>{const $=e?k:p,l=e?p:k,g=e?R:f;sn($,g?l.cloneNode(!0):l,i,s,!g)},u)},c)},a),n}o.after=function(){return O(arguments,this,!1,!1,!1,!0,!0)},o.append=function(){return O(arguments,this,!1,!1,!0)};function rn(t){if(!arguments.length)return this[0]&&this[0].innerHTML;if(T(t))return this;const n=/<script[\s>]/.test(t);return this.each((e,i)=>{m(i)&&(n?r(i).empty().append(t):i.innerHTML=t)})}o.html=rn,o.appendTo=function(t){return O(arguments,this,!0,!1,!0)},o.wrapInner=function(t){return this.each((n,e)=>{const i=r(e),s=i.contents();s.length?s.wrapAll(t):i.append(t)})},o.before=function(){return O(arguments,this,!1,!0)},o.wrapAll=function(t){let n=r(t),e=n[0];for(;e.children.length;)e=e.firstElementChild;return this.first().before(n),this.appendTo(e)},o.wrap=function(t){return this.each((n,e)=>{const i=r(t)[0];r(e).wrapAll(n?i.cloneNode(!0):i)})},o.insertAfter=function(t){return O(arguments,this,!0,!1,!1,!1,!1,!0)},o.insertBefore=function(t){return O(arguments,this,!0,!0)},o.prepend=function(){return O(arguments,this,!1,!0,!0,!0,!0)},o.prependTo=function(t){return O(arguments,this,!0,!0,!0,!1,!1,!0)},o.contents=function(){return r(S(N(this,t=>t.tagName==="IFRAME"?[t.contentDocument]:t.tagName==="TEMPLATE"?t.content.childNodes:t.childNodes)))},o.next=function(t,n,e){return H(r(S(N(this,"nextElementSibling",n,e))),t)},o.nextAll=function(t){return this.next(t,!0)},o.nextUntil=function(t,n){return this.next(n,!0,t)},o.parents=function(t,n){return H(r(S(N(this,"parentElement",!0,n))),t)},o.parentsUntil=function(t,n){return this.parents(n,t)},o.prev=function(t,n,e){return H(r(S(N(this,"previousElementSibling",n,e))),t)},o.prevAll=function(t){return this.prev(t,!0)},o.prevUntil=function(t,n){return this.prev(n,!0,t)},o.map=function(t){return r(Mt.apply([],ht.call(this,(n,e)=>t.call(n,e,n))))},o.clone=function(){return this.map((t,n)=>n.cloneNode(!0))},o.offsetParent=function(){return this.map((t,n)=>{let e=n.offsetParent;for(;e&&_(e,"position")==="static";)e=e.offsetParent;return e||ct})},o.slice=function(t,n){return r(pt.call(this,t,n))};const on=/-([a-z])/g;function nt(t){return t.replace(on,(n,e)=>e.toUpperCase())}o.ready=function(t){const n=()=>setTimeout(t,0,r);return w.readyState!=="loading"?n():w.addEventListener("DOMContentLoaded",n),this},o.unwrap=function(){return this.parent().each((t,n)=>{if(n.tagName==="BODY")return;const e=r(n);e.replaceWith(e.children())}),this},o.offset=function(){const t=this[0];if(!t)return;const n=t.getBoundingClientRect();return{top:n.top+I.pageYOffset,left:n.left+I.pageXOffset}},o.position=function(){const t=this[0];if(!t)return;const n=_(t,"position")==="fixed",e=n?t.getBoundingClientRect():this.offset();if(!n){const i=t.ownerDocument;let s=t.offsetParent||i.documentElement;for(;(s===i.body||s===i.documentElement)&&_(s,"position")==="static";)s=s.parentNode;if(s!==t&&m(s)){const a=r(s).offset();e.top-=a.top+E(s,"borderTopWidth"),e.left-=a.left+E(s,"borderLeftWidth")}}return{top:e.top-E(t,"marginTop"),left:e.left-E(t,"marginLeft")}};const Tt={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};o.prop=function(t,n){if(t){if(x(t))return t=Tt[t]||t,arguments.length<2?this[0]&&this[0][t]:this.each((e,i)=>{i[t]=n});for(const e in t)this.prop(e,t[e]);return this}},o.removeProp=function(t){return this.each((n,e)=>{delete e[Tt[t]||t]})};const an=/^--/;function et(t){return an.test(t)}const it={},{style:cn}=ut,un=["webkit","moz","ms"];function ln(t,n=et(t)){if(n)return t;if(!it[t]){const e=nt(t),i=`${e[0].toUpperCase()}${e.slice(1)}`,s=`${e} ${un.join(`${i} `)}${i}`.split(" ");y(s,(a,c)=>{if(c in cn)return it[t]=c,!1})}return it[t]}const fn={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function $t(t,n,e=et(t)){return!e&&!fn[t]&&gt(n)?`${n}px`:n}function dn(t,n){if(x(t)){const e=et(t);return t=ln(t,e),arguments.length<2?this[0]&&_(this[0],t,e):t?(n=$t(t,n,e),this.each((i,s)=>{m(s)&&(e?s.style.setProperty(t,n):s.style[t]=n)})):this}for(const e in t)this.css(e,t[e]);return this}o.css=dn;function At(t,n){try{return t(n)}catch{return n}}const hn=/^\s+|\s+$/;function Et(t,n){const e=t.dataset[n]||t.dataset[nt(n)];return hn.test(e)?e:At(JSON.parse,e)}function pn(t,n,e){e=At(JSON.stringify,e),t.dataset[nt(n)]=e}function gn(t,n){if(!t){if(!this[0])return;const e={};for(const i in this[0].dataset)e[i]=Et(this[0],i);return e}if(x(t))return arguments.length<2?this[0]&&Et(this[0],t):T(n)?this:this.each((e,i)=>{pn(i,t,n)});for(const e in t)this.data(e,t[e]);return this}o.data=gn;function St(t,n){const e=t.documentElement;return Math.max(t.body[`scroll${n}`],e[`scroll${n}`],t.body[`offset${n}`],e[`offset${n}`],e[`client${n}`])}y([!0,!1],(t,n)=>{y(["Width","Height"],(e,i)=>{const s=`${n?"outer":"inner"}${i}`;o[s]=function(a){if(this[0])return L(this[0])?n?this[0][`inner${i}`]:this[0].document.documentElement[`client${i}`]:B(this[0])?St(this[0],i):this[0][`${n?"offset":"client"}${i}`]+(a&&n?E(this[0],`margin${e?"Top":"Left"}`)+E(this[0],`margin${e?"Bottom":"Right"}`):0)}})}),y(["Width","Height"],(t,n)=>{const e=n.toLowerCase();o[e]=function(i){if(!this[0])return T(i)?void 0:this;if(!arguments.length)return L(this[0])?this[0].document.documentElement[`client${n}`]:B(this[0])?St(this[0],n):this[0].getBoundingClientRect()[e]-mt(this[0],!t);const s=parseInt(i,10);return this.each((a,c)=>{if(!m(c))return;const u=_(c,"boxSizing");c.style[e]=$t(e,s+(u==="border-box"?mt(c,!t):0))})}});const _t="___cd";o.toggle=function(t){return this.each((n,e)=>{if(!m(e))return;const i=yt(e);(T(t)?i:t)?(e.style.display=e[_t]||"",yt(e)&&(e.style.display=Gt(e.tagName))):i||(e[_t]=_(e,"display"),e.style.display="none")})},o.hide=function(){return this.toggle(!1)},o.show=function(){return this.toggle(!0)};const Nt="___ce",st=".",rt={focus:"focusin",blur:"focusout"},Rt={mouseenter:"mouseover",mouseleave:"mouseout"},mn=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function ot(t){return Rt[t]||rt[t]||t}function at(t){const n=t.split(st);return[n[0],n.slice(1).sort()]}o.trigger=function(t,n){if(x(t)){const[i,s]=at(t),a=ot(i);if(!a)return this;const c=mn.test(a)?"MouseEvents":"HTMLEvents";t=w.createEvent(c),t.initEvent(a,!0,!0),t.namespace=s.join(st),t.___ot=i}t.___td=n;const e=t.___ot in rt;return this.each((i,s)=>{e&&M(s[t.___ot])&&(s[`___i${t.type}`]=!0,s[t.___ot](),s[`___i${t.type}`]=!1),s.dispatchEvent(t)})};function kt(t){return t[Nt]=t[Nt]||{}}function yn(t,n,e,i,s){const a=kt(t);a[n]=a[n]||[],a[n].push([e,i,s]),t.addEventListener(n,s)}function It(t,n){return!n||!X.call(n,e=>t.indexOf(e)<0)}function J(t,n,e,i,s){const a=kt(t);if(n)a[n]&&(a[n]=a[n].filter(([c,u,d])=>{if(s&&d.guid!==s.guid||!It(c,e)||i&&i!==u)return!0;t.removeEventListener(n,d)}));else for(n in a)J(t,n,e,i,s)}o.off=function(t,n,e){if(T(t))this.each((i,s)=>{!m(s)&&!B(s)&&!L(s)||J(s)});else if(x(t))M(n)&&(e=n,n=""),y(U(t),(i,s)=>{const[a,c]=at(s),u=ot(a);this.each((d,h)=>{!m(h)&&!B(h)&&!L(h)||J(h,u,c,n,e)})});else for(const i in t)this.off(i,t[i]);return this},o.remove=function(t){return H(this,t).detach().off(),this},o.replaceWith=function(t){return this.before(t).remove()},o.replaceAll=function(t){return r(t).replaceWith(this),this};function bn(t,n,e,i,s){if(!x(t)){for(const a in t)this.on(a,n,e,t[a],s);return this}return x(n)||(T(n)||F(n)?n="":T(e)?(e=n,n=""):(i=e,e=n,n="")),M(i)||(i=e,e=void 0),i?(y(U(t),(a,c)=>{const[u,d]=at(c),h=ot(u),R=u in Rt,k=u in rt;h&&this.each((f,p)=>{if(!m(p)&&!B(p)&&!L(p))return;const $=function(l){if(l.target[`___i${l.type}`])return l.stopImmediatePropagation();if(l.namespace&&!It(d,l.namespace.split(st))||!n&&(k&&(l.target!==p||l.___ot===h)||R&&l.relatedTarget&&p.contains(l.relatedTarget)))return;let g=p;if(n){let C=l.target;for(;!bt(C,n);)if(C===p||(C=C.parentNode,!C))return;g=C}Object.defineProperty(l,"currentTarget",{configurable:!0,get(){return g}}),Object.defineProperty(l,"delegateTarget",{configurable:!0,get(){return p}}),Object.defineProperty(l,"data",{configurable:!0,get(){return e}});const A=i.call(g,l,l.___td);s&&J(p,h,d,n,$),A===!1&&(l.preventDefault(),l.stopPropagation())};$.guid=i.guid=i.guid||r.guid++,yn(p,h,d,n,$)})}),this):this}o.on=bn;function xn(t,n,e,i){return this.on(t,n,e,i,!0)}o.one=xn;const Cn=/\r?\n/g;function wn(t,n){return`&${encodeURIComponent(t)}=${encodeURIComponent(n.replace(Cn,`\r
`))}`}const Tn=/file|reset|submit|button|image/i,Ht=/radio|checkbox/i;o.serialize=function(){let t="";return this.each((n,e)=>{y(e.elements||[e],(i,s)=>{if(s.disabled||!s.name||s.tagName==="FIELDSET"||Tn.test(s.type)||Ht.test(s.type)&&!s.checked)return;const a=wt(s);if(!T(a)){const c=z(a)?a:[a];y(c,(u,d)=>{t+=wn(s.name,d)})}})}),t.slice(1)};function $n(t){var n=window.getComputedStyle(t);return n.display==="none"||parseInt(n.height)===0}function An(){return this.filter(function(t,n){return!$n(n)})}function En(t){return t instanceof Element?"element":Object.prototype.toString.call(t).replace(/\[object\s(.+)\]/,"$1").toLowerCase()}const Sn=".a4-container{font-size:9pt;line-height:18pt;letter-spacing:1px;width:210mm;margin:0 auto;box-sizing:border-box;background:#fff!important;color:#000!important}.a4-container table{line-height:1.5}.a4-page{box-shadow:0 0 8px 4px #ccc;padding:50px;margin-top:20px;page-break-after:always;position:relative;min-height:294mm;box-sizing:border-box}.a4-page:first-child{margin-top:30px}.a4-page:last-child{page-break-after:unset;margin-bottom:20px}table.a4-table{border-collapse:collapse;border:1px solid black}table.a4-table td,table.a4-table th{border:1px solid black}@media print{.a4-container{width:100%!important}.a4-container .a4-page{box-shadow:none;margin:0;max-height:294mm}.a4-page:first-child{margin-top:0}img{max-height:902px}@page{size:a4;padding:0;margin:0}}";function _n(t="a4-container",n="auto",e=500,i=500){e=isNaN(parseInt(e))?500:parseInt(e),i=isNaN(parseInt(i))?500:parseInt(i),e<10&&(e=10),i<10&&(i=10),t||(t=".a4-container"),["manual","auto"].includes(n)||(n="auto"),Nn(Sn);const s=Rn();r("body").__proto__.notHidden=An;function a(){kn(t,n),In(),console.log("start paging:",{mode:n,root:t||".a4-container"});let u=0,d=Ot();for(;d.length;){if(++u>i){console.error(`Pagination operation exceeds limit (${i} pages). If it's normal, you can change this limit in the initialization method.`);break}d=Ot(c(d))}console.log("end paging")}function c(u,d=0){if(u.outerHeight()<=294*s+5)return u;if(++d>e)return console.error(`Pagination operation exceeds recursion limit (${e} pages), you can change this limit in the initialization method.`),u;const h=u.offset().top,R=parseInt(u.css("paddingBottom"));let k=!1,f=null;return u.find(".a4-unit").notHidden().each(function(p,$){if(r(this).offset().top+r(this).outerHeight()-h+parseInt(r(this).css("marginBottom"))<=294*s-R)return!0;k=!0;let l=u.attr("class");return u.hasClass("new-a4-page")||(l+=" new-a4-page"),f=r(`<div class="${l}" style="display:block"></div>`),p===0?(console.warn("There is an element that exceeds the page height, and the page height is fixed to avoid pagnation bug."),console.log(this),u.css("overflow","hidden"),u.css("height",`${294*s}px`),f.append(r(this).nextAll().clone()),r(this).nextAll().remove(),u.after(f),!1):(r(this).hasClass("table-break")?vn.call(this,f,p):r(this).hasClass("thead-break")?On.call(this,f):r(this).parent().hasClass("a4-unit-wrap")?Hn.call(this,f):vt.call(this,f),u.after(f),!1)}),k?c(f,d):u}return{execPaging:a}}function Nn(t){if(document.getElementById("print-style"))return;const n=document.createElement("style");n.id="print-style",n.setAttribute("type","text/css"),n.innerHTML=t,document.head.append(n)}function Rn(){const t=document.createElement("div");t.id="mm",t.style.width="1mm",document.querySelector("body").appendChild(t);let n=document.getElementById("mm").getBoundingClientRect();return r("#mm").remove(),n.width}function kn(t,n){if(n==="manual")return;let e;const i=En(t);["string","element","htmlcollection"].includes(i)?e=r(t):console.warn("Unexpected root type:",i),e!=null&&e.length&&(e.addClass("a4-container"),e.children().notHidden().each(function(){r(this).addClass("a4-page"),r(this).children().notHidden().each(function(s,a){if(a.tagName.toLowerCase()==="table")r(this).addClass("a4-table");else{if(["a4-unit-wrap"].some(c=>a.classList.contains(c)))return;r(this).addClass("a4-unit")}})}))}function In(){r("table.a4-table").children("thead").addClass("a4-unit thead-break"),r("table.a4-table tbody tr").addClass("a4-unit table-break"),r(".a4-unit-wrap").children().notHidden().addClass("a4-unit")}function Ot(t){return t?t.nextAll(".a4-page").notHidden().first():r(".a4-page").notHidden().first()}function vt(t){!t||!this||(t.append(r(this).clone()),t.append(r(this).nextAll().clone()),r(this).nextAll().remove(),r(this).remove())}function Hn(t){if(!t||!this)return;if(r(this).prev().length===0)vt.call(r(this).parent(),t);else{const e=r(this).parent().clone().empty();e.append(r(this).clone()),e.append(r(this).nextAll().clone()),t.append(e),t.append(r(this).parent().nextAll().clone()),r(this).parent().nextAll().remove(),r(this).nextAll().remove(),r(this).remove()}}function On(t){!t||!this||(t.append(r(this).parents("table").clone()),t.append(r(this).parents("table").nextAll().clone()),r(this).parents("table").nextAll().remove(),r(this).parents("table").remove())}function vn(t,n){var e=r(`<table class="${r(this).parents("table").attr("class")}"></table>`);e.append("<tbody></tbody>");var i=r(this);let s=n>1;if(n==1&&(s=r(this).find(".a4-unit").notHidden().not(".thead-break").length!==0),s){e.prepend(i.parents("table").children("thead").clone());let a=r(this).prevAll("tr"),c=[],u=[];for(let f=a.length-1;f>=0;f--){const p=a[f],$=f===a.length-1,l=r(p).find("td");if($||(c=c.map(g=>g-1>0?g-1:0)),$){let g=0;for(let A=0,C=l.length;A<C;A++)g+=+r(l[A]).attr("colspan")||1;c=new Array(g).fill(0)}for(let g=0,A=l.length;g<A;g++){const C=l[g],W=+r(C).attr("rowspan")||1,P=+r(C).attr("colspan")||1;if(P>0){let j=c.findIndex(b=>b<1);for(let b=0;b<P;b++)c[j+b]=(c[j+b]||0)+W;if(W>1){u[j]=[f,g,W,P];for(let b=1;b<P;b++)u[j+b]=void 0}}}}let d=c.map(f=>f>1?"N":0);i.find("td").each(function(f){const p=+r(this).attr("colspan")||1,$=d.findIndex(l=>l===0);for(let l=0;l<p;l++)d[$+l]=f+1});const h={};for(let f=0;f<u.length;f++){if(!u[f])continue;const[p,$,l,g]=u[f]||[],A=l-p-1;if(A<=0)continue;const C=r(a[p]).find("td")[$];r(C).attr("rowspan",l-A);const W=r(C).clone().attr("rowspan",A),P="splitTd"+f;h[P]=W;let j=d.findIndex(b=>b==="N");if(j!==-1)for(let b=0;b<g;b++)d[j+b]=P}const R=i.clone().empty();[...new Set(d)].forEach(f=>{typeof f=="string"?R.append(h[f]):R.append(i.find("td").eq(f-1).clone())});const k=i.prev("tr").length===0;e.children("tbody").append(R.clone()),e.children("tbody").append(i.nextAll().clone()),t.append(e),t.append(i.parents("table").nextAll().clone()),i.nextAll().remove(),i.parents("table").nextAll().remove(),k?i.parents("table").remove():i.remove()}else{i.nextAll().length?(e.prepend(i.parents("table").children("thead").clone()),e.children("tbody").append(i.nextAll().clone()),i.nextAll().remove(),t.append(e),t.append(i.parents("table").nextAll().clone()),i.parents("table").nextAll().remove()):(t.append(i.parents("table").nextAll().clone()),i.parents("table").nextAll().remove());let a=r(`<div style="height:${294*pixelRatio-100}px;overflow:hidden;"></div>`);i.parents(".a4-page").append(a),a.append(i.parents("table"))}}return _n});
