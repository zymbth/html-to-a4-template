(function(E,v){typeof exports=="object"&&typeof module<"u"?module.exports=v():typeof define=="function"&&define.amd?define(v):(E=typeof globalThis<"u"?globalThis:E||self,E.html2a4tmpl=v())})(this,function(){"use strict";const E=document,v=window,mt=E.documentElement,M=E.createElement.bind(E),bt=M("div"),et=M("table"),Wt=M("tbody"),yt=M("tr"),{isArray:G,prototype:xt}=Array,{concat:qt,filter:nt,indexOf:Ct,map:wt,push:zt,slice:Tt,some:it,splice:Vt}=xt,Ut=/^#(?:[\w-]|\\.|[^\x00-\xa0])*$/,Jt=/^\.(?:[\w-]|\\.|[^\x00-\xa0])*$/,Yt=/<.+>/,Gt=/^\w+$/;function rt(t,e){const n=Xt(e);return!t||!n&&!j(e)&&!b(e)?[]:!n&&Jt.test(t)?e.getElementsByClassName(t.slice(1).replace(/\\/g,"")):!n&&Gt.test(t)?e.getElementsByTagName(t):e.querySelectorAll(t)}class X{constructor(e,n){if(!e)return;if(st(e))return e;let i=e;if(w(e)){const r=n||E;if(i=Ut.test(e)&&j(r)?r.getElementById(e.slice(1).replace(/\\/g,"")):Yt.test(e)?At(e):st(r)?r.find(e):w(r)?s(r).find(e):rt(e,r),!i)return}else if(D(e))return this.ready(e);(i.nodeType||i===v)&&(i=[i]),this.length=i.length;for(let r=0,c=this.length;r<c;r++)this[r]=i[r]}init(e,n){return new X(e,n)}}const o=X.prototype,s=o.init;s.fn=s.prototype=o,o.length=0,o.splice=Vt,typeof Symbol=="function"&&(o[Symbol.iterator]=xt[Symbol.iterator]);function st(t){return t instanceof X}function z(t){return!!t&&t===t.window}function j(t){return!!t&&t.nodeType===9}function Xt(t){return!!t&&t.nodeType===11}function b(t){return!!t&&t.nodeType===1}function Kt(t){return!!t&&t.nodeType===3}function Qt(t){return typeof t=="boolean"}function D(t){return typeof t=="function"}function w(t){return typeof t=="string"}function $(t){return t===void 0}function J(t){return t===null}function kt(t){return!isNaN(parseFloat(t))&&isFinite(t)}function ot(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}s.isWindow=z,s.isFunction=D,s.isArray=G,s.isNumeric=kt,s.isPlainObject=ot;function y(t,e,n){if(n){let i=t.length;for(;i--;)if(e.call(t[i],i,t[i])===!1)return t}else if(ot(t)){const i=Object.keys(t);for(let r=0,c=i.length;r<c;r++){const a=i[r];if(e.call(t[a],a,t[a])===!1)return t}}else for(let i=0,r=t.length;i<r;i++)if(e.call(t[i],i,t[i])===!1)return t;return t}s.each=y,o.each=function(t){return y(this,t)},o.empty=function(){return this.each((t,e)=>{for(;e.firstChild;)e.removeChild(e.firstChild)})};function K(...t){const e=Qt(t[0])?t.shift():!1,n=t.shift(),i=t.length;if(!n)return{};if(!i)return K(e,s,n);for(let r=0;r<i;r++){const c=t[r];for(const a in c)e&&(G(c[a])||ot(c[a]))?((!n[a]||n[a].constructor!==c[a].constructor)&&(n[a]=new c[a].constructor),K(e,n[a],c[a])):n[a]=c[a]}return n}s.extend=K,o.extend=function(t){return K(o,t)};const Zt=/\S+/g;function Q(t){return w(t)?t.match(Zt)||[]:[]}o.toggleClass=function(t,e){const n=Q(t),i=!$(e);return this.each((r,c)=>{b(c)&&y(n,(a,d)=>{i?e?c.classList.add(d):c.classList.remove(d):c.classList.toggle(d)})})},o.addClass=function(t){return this.toggleClass(t,!0)},o.removeAttr=function(t){const e=Q(t);return this.each((n,i)=>{b(i)&&y(e,(r,c)=>{i.removeAttribute(c)})})};function te(t,e){if(t){if(w(t)){if(arguments.length<2){if(!this[0]||!b(this[0]))return;const n=this[0].getAttribute(t);return J(n)?void 0:n}return $(e)?this:J(e)?this.removeAttr(t):this.each((n,i)=>{b(i)&&i.setAttribute(t,e)})}for(const n in t)this.attr(n,t[n]);return this}}o.attr=te,o.removeClass=function(t){return arguments.length?this.toggleClass(t,!1):this.attr("class","")},o.hasClass=function(t){return!!t&&it.call(this,e=>b(e)&&e.classList.contains(t))},o.get=function(t){return $(t)?Tt.call(this):(t=Number(t),this[t<0?t+this.length:t])},o.eq=function(t){return s(this.get(t))},o.first=function(){return this.eq(0)},o.last=function(){return this.eq(-1)};function ee(t){return $(t)?this.get().map(e=>b(e)||Kt(e)?e.textContent:"").join(""):this.each((e,n)=>{b(n)&&(n.textContent=t)})}o.text=ee;function L(t,e,n){if(!b(t))return;const i=v.getComputedStyle(t,null);return n?i.getPropertyValue(e)||void 0:i[e]||t.style[e]}function R(t,e){return parseInt(L(t,e),10)||0}function Et(t,e){return R(t,`border${e?"Left":"Top"}Width`)+R(t,`padding${e?"Left":"Top"}`)+R(t,`padding${e?"Right":"Bottom"}`)+R(t,`border${e?"Right":"Bottom"}Width`)}const ct={};function ne(t){if(ct[t])return ct[t];const e=M(t);E.body.insertBefore(e,null);const n=L(e,"display");return E.body.removeChild(e),ct[t]=n!=="none"?n:"block"}function $t(t){return L(t,"display")==="none"}function St(t,e){const n=t&&(t.matches||t.webkitMatchesSelector||t.msMatchesSelector);return!!n&&!!e&&n.call(t,e)}function Z(t){return w(t)?(e,n)=>St(n,t):D(t)?t:st(t)?(e,n)=>t.is(n):t?(e,n)=>n===t:()=>!1}o.filter=function(t){const e=Z(t);return s(nt.call(this,(n,i)=>e.call(n,i,n)))};function B(t,e){return e?t.filter(e):t}o.detach=function(t){return B(this,t).each((e,n)=>{n.parentNode&&n.parentNode.removeChild(n)}),this};const ie=/^\s*<(\w+)[^>]*>/,re=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,_t={"*":bt,tr:Wt,td:yt,th:yt,thead:et,tbody:et,tfoot:et};function At(t){if(!w(t))return[];if(re.test(t))return[M(RegExp.$1)];const e=ie.test(t)&&RegExp.$1,n=_t[e]||_t["*"];return n.innerHTML=t,s(n.childNodes).detach().get()}s.parseHTML=At,o.has=function(t){const e=w(t)?(n,i)=>rt(t,i).length:(n,i)=>i.contains(t);return this.filter(e)},o.not=function(t){const e=Z(t);return this.filter((n,i)=>(!w(t)||b(i))&&!e.call(i,n,i))};function O(t,e,n,i){const r=[],c=D(e),a=i&&Z(i);for(let d=0,k=t.length;d<k;d++)if(c){const p=e(t[d]);p.length&&zt.apply(r,p)}else{let p=t[d][e];for(;p!=null&&!(i&&a(-1,p));)r.push(p),p=n?p[e]:null}return r}function Rt(t){return t.multiple&&t.options?O(nt.call(t.options,e=>e.selected&&!e.disabled&&!e.parentNode.disabled),"value"):t.value||""}function se(t){return arguments.length?this.each((e,n)=>{const i=n.multiple&&n.options;if(i||Dt.test(n.type)){const r=G(t)?wt.call(t,String):J(t)?[]:[String(t)];i?y(n.options,(c,a)=>{a.selected=r.indexOf(a.value)>=0},!0):n.checked=r.indexOf(n.value)>=0}else n.value=$(t)||J(t)?"":t}):this[0]&&Rt(this[0])}o.val=se,o.is=function(t){const e=Z(t);return it.call(this,(n,i)=>e.call(n,i,n))},s.guid=1;function N(t){return t.length>1?nt.call(t,(e,n,i)=>Ct.call(i,e)===n):t}s.unique=N,o.add=function(t,e){return s(N(this.get().concat(s(t,e).get())))},o.children=function(t){return B(s(N(O(this,e=>e.children))),t)},o.parent=function(t){return B(s(N(O(this,"parentNode"))),t)},o.index=function(t){const e=t?s(t)[0]:this[0],n=t?this:s(e).parent().children();return Ct.call(n,e)},o.closest=function(t){const e=this.filter(t);if(e.length)return e;const n=this.parent();return n.length?n.closest(t):e},o.siblings=function(t){return B(s(N(O(this,e=>s(e).parent().children().not(e)))),t)},o.find=function(t){return s(N(O(this,e=>rt(t,e))))};const oe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ce=/^$|^module$|\/(java|ecma)script/i,ae=["type","src","nonce","noModule"];function ue(t,e){const n=s(t);n.filter("script").add(n.find("script")).each((i,r)=>{if(ce.test(r.type)&&mt.contains(r)){const c=M("script");c.text=r.textContent.replace(oe,""),y(ae,(a,d)=>{r[d]&&(c[d]=r[d])}),e.head.insertBefore(c,null),e.head.removeChild(c)}})}function fe(t,e,n,i,r){i?t.insertBefore(e,n?t.firstChild:null):t.nodeName==="HTML"?t.parentNode.replaceChild(e,t):t.parentNode.insertBefore(e,n?t:t.nextSibling),r&&ue(e,t.ownerDocument)}function I(t,e,n,i,r,c,a,d){return y(t,(k,p)=>{y(s(p),(f,h)=>{y(s(e),(g,u)=>{const S=n?h:u,l=n?u:h,x=n?f:g;fe(S,x?l.cloneNode(!0):l,i,r,!x)},d)},a)},c),e}o.after=function(){return I(arguments,this,!1,!1,!1,!0,!0)},o.append=function(){return I(arguments,this,!1,!1,!0)};function le(t){if(!arguments.length)return this[0]&&this[0].innerHTML;if($(t))return this;const e=/<script[\s>]/.test(t);return this.each((n,i)=>{b(i)&&(e?s(i).empty().append(t):i.innerHTML=t)})}o.html=le,o.appendTo=function(t){return I(arguments,this,!0,!1,!0)},o.wrapInner=function(t){return this.each((e,n)=>{const i=s(n),r=i.contents();r.length?r.wrapAll(t):i.append(t)})},o.before=function(){return I(arguments,this,!1,!0)},o.wrapAll=function(t){let e=s(t),n=e[0];for(;n.children.length;)n=n.firstElementChild;return this.first().before(e),this.appendTo(n)},o.wrap=function(t){return this.each((e,n)=>{const i=s(t)[0];s(n).wrapAll(e?i.cloneNode(!0):i)})},o.insertAfter=function(t){return I(arguments,this,!0,!1,!1,!1,!1,!0)},o.insertBefore=function(t){return I(arguments,this,!0,!0)},o.prepend=function(){return I(arguments,this,!1,!0,!0,!0,!0)},o.prependTo=function(t){return I(arguments,this,!0,!0,!0,!1,!1,!0)},o.contents=function(){return s(N(O(this,t=>t.tagName==="IFRAME"?[t.contentDocument]:t.tagName==="TEMPLATE"?t.content.childNodes:t.childNodes)))},o.next=function(t,e,n){return B(s(N(O(this,"nextElementSibling",e,n))),t)},o.nextAll=function(t){return this.next(t,!0)},o.nextUntil=function(t,e){return this.next(e,!0,t)},o.parents=function(t,e){return B(s(N(O(this,"parentElement",!0,e))),t)},o.parentsUntil=function(t,e){return this.parents(e,t)},o.prev=function(t,e,n){return B(s(N(O(this,"previousElementSibling",e,n))),t)},o.prevAll=function(t){return this.prev(t,!0)},o.prevUntil=function(t,e){return this.prev(e,!0,t)},o.map=function(t){return s(qt.apply([],wt.call(this,(e,n)=>t.call(e,n,e))))},o.clone=function(){return this.map((t,e)=>e.cloneNode(!0))},o.offsetParent=function(){return this.map((t,e)=>{let n=e.offsetParent;for(;n&&L(n,"position")==="static";)n=n.offsetParent;return n||mt})},o.slice=function(t,e){return s(Tt.call(this,t,e))};const de=/-([a-z])/g;function at(t){return t.replace(de,(e,n)=>n.toUpperCase())}o.ready=function(t){const e=()=>setTimeout(t,0,s);return E.readyState!=="loading"?e():E.addEventListener("DOMContentLoaded",e),this},o.unwrap=function(){return this.parent().each((t,e)=>{if(e.tagName==="BODY")return;const n=s(e);n.replaceWith(n.children())}),this},o.offset=function(){const t=this[0];if(!t)return;const e=t.getBoundingClientRect();return{top:e.top+v.pageYOffset,left:e.left+v.pageXOffset}},o.position=function(){const t=this[0];if(!t)return;const e=L(t,"position")==="fixed",n=e?t.getBoundingClientRect():this.offset();if(!e){const i=t.ownerDocument;let r=t.offsetParent||i.documentElement;for(;(r===i.body||r===i.documentElement)&&L(r,"position")==="static";)r=r.parentNode;if(r!==t&&b(r)){const c=s(r).offset();n.top-=c.top+R(r,"borderTopWidth"),n.left-=c.left+R(r,"borderLeftWidth")}}return{top:n.top-R(t,"marginTop"),left:n.left-R(t,"marginLeft")}};const Nt={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};o.prop=function(t,e){if(t){if(w(t))return t=Nt[t]||t,arguments.length<2?this[0]&&this[0][t]:this.each((n,i)=>{i[t]=e});for(const n in t)this.prop(n,t[n]);return this}},o.removeProp=function(t){return this.each((e,n)=>{delete n[Nt[t]||t]})};const he=/^--/;function ut(t){return he.test(t)}const ft={},{style:pe}=bt,ge=["webkit","moz","ms"];function me(t,e=ut(t)){if(e)return t;if(!ft[t]){const n=at(t),i=`${n[0].toUpperCase()}${n.slice(1)}`,r=`${n} ${ge.join(`${i} `)}${i}`.split(" ");y(r,(c,a)=>{if(a in pe)return ft[t]=a,!1})}return ft[t]}const be={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function Lt(t,e,n=ut(t)){return!n&&!be[t]&&kt(e)?`${e}px`:e}function ye(t,e){if(w(t)){const n=ut(t);return t=me(t,n),arguments.length<2?this[0]&&L(this[0],t,n):t?(e=Lt(t,e,n),this.each((i,r)=>{b(r)&&(n?r.style.setProperty(t,e):r.style[t]=e)})):this}for(const n in t)this.css(n,t[n]);return this}o.css=ye;function Ot(t,e){try{return t(e)}catch{return e}}const xe=/^\s+|\s+$/;function Ht(t,e){const n=t.dataset[e]||t.dataset[at(e)];return xe.test(n)?n:Ot(JSON.parse,n)}function Ce(t,e,n){n=Ot(JSON.stringify,n),t.dataset[at(e)]=n}function we(t,e){if(!t){if(!this[0])return;const n={};for(const i in this[0].dataset)n[i]=Ht(this[0],i);return n}if(w(t))return arguments.length<2?this[0]&&Ht(this[0],t):$(e)?this:this.each((n,i)=>{Ce(i,t,e)});for(const n in t)this.data(n,t[n]);return this}o.data=we;function vt(t,e){const n=t.documentElement;return Math.max(t.body[`scroll${e}`],n[`scroll${e}`],t.body[`offset${e}`],n[`offset${e}`],n[`client${e}`])}y([!0,!1],(t,e)=>{y(["Width","Height"],(n,i)=>{const r=`${e?"outer":"inner"}${i}`;o[r]=function(c){if(this[0])return z(this[0])?e?this[0][`inner${i}`]:this[0].document.documentElement[`client${i}`]:j(this[0])?vt(this[0],i):this[0][`${e?"offset":"client"}${i}`]+(c&&e?R(this[0],`margin${n?"Top":"Left"}`)+R(this[0],`margin${n?"Bottom":"Right"}`):0)}})}),y(["Width","Height"],(t,e)=>{const n=e.toLowerCase();o[n]=function(i){if(!this[0])return $(i)?void 0:this;if(!arguments.length)return z(this[0])?this[0].document.documentElement[`client${e}`]:j(this[0])?vt(this[0],e):this[0].getBoundingClientRect()[n]-Et(this[0],!t);const r=parseInt(i,10);return this.each((c,a)=>{if(!b(a))return;const d=L(a,"boxSizing");a.style[n]=Lt(n,r+(d==="border-box"?Et(a,!t):0))})}});const Bt="___cd";o.toggle=function(t){return this.each((e,n)=>{if(!b(n))return;const i=$t(n);($(t)?i:t)?(n.style.display=n[Bt]||"",$t(n)&&(n.style.display=ne(n.tagName))):i||(n[Bt]=L(n,"display"),n.style.display="none")})},o.hide=function(){return this.toggle(!1)},o.show=function(){return this.toggle(!0)};const It="___ce",lt=".",dt={focus:"focusin",blur:"focusout"},Pt={mouseenter:"mouseover",mouseleave:"mouseout"},Te=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function ht(t){return Pt[t]||dt[t]||t}function pt(t){const e=t.split(lt);return[e[0],e.slice(1).sort()]}o.trigger=function(t,e){if(w(t)){const[i,r]=pt(t),c=ht(i);if(!c)return this;const a=Te.test(c)?"MouseEvents":"HTMLEvents";t=E.createEvent(a),t.initEvent(c,!0,!0),t.namespace=r.join(lt),t.___ot=i}t.___td=e;const n=t.___ot in dt;return this.each((i,r)=>{n&&D(r[t.___ot])&&(r[`___i${t.type}`]=!0,r[t.___ot](),r[`___i${t.type}`]=!1),r.dispatchEvent(t)})};function Mt(t){return t[It]=t[It]||{}}function ke(t,e,n,i,r){const c=Mt(t);c[e]=c[e]||[],c[e].push([n,i,r]),t.addEventListener(e,r)}function jt(t,e){return!e||!it.call(e,n=>t.indexOf(n)<0)}function tt(t,e,n,i,r){const c=Mt(t);if(e)c[e]&&(c[e]=c[e].filter(([a,d,k])=>{if(r&&k.guid!==r.guid||!jt(a,n)||i&&i!==d)return!0;t.removeEventListener(e,k)}));else for(e in c)tt(t,e,n,i,r)}o.off=function(t,e,n){if($(t))this.each((i,r)=>{!b(r)&&!j(r)&&!z(r)||tt(r)});else if(w(t))D(e)&&(n=e,e=""),y(Q(t),(i,r)=>{const[c,a]=pt(r),d=ht(c);this.each((k,p)=>{!b(p)&&!j(p)&&!z(p)||tt(p,d,a,e,n)})});else for(const i in t)this.off(i,t[i]);return this},o.remove=function(t){return B(this,t).detach().off(),this},o.replaceWith=function(t){return this.before(t).remove()},o.replaceAll=function(t){return s(t).replaceWith(this),this};function Ee(t,e,n,i,r){if(!w(t)){for(const c in t)this.on(c,e,n,t[c],r);return this}return w(e)||($(e)||J(e)?e="":$(n)?(n=e,e=""):(i=n,n=e,e="")),D(i)||(i=n,n=void 0),i?(y(Q(t),(c,a)=>{const[d,k]=pt(a),p=ht(d),f=d in Pt,h=d in dt;p&&this.each((g,u)=>{if(!b(u)&&!j(u)&&!z(u))return;const S=function(l){if(l.target[`___i${l.type}`])return l.stopImmediatePropagation();if(l.namespace&&!jt(k,l.namespace.split(lt))||!e&&(h&&(l.target!==u||l.___ot===p)||f&&l.relatedTarget&&u.contains(l.relatedTarget)))return;let x=u;if(e){let T=l.target;for(;!St(T,e);)if(T===u||(T=T.parentNode,!T))return;x=T}Object.defineProperty(l,"currentTarget",{configurable:!0,get(){return x}}),Object.defineProperty(l,"delegateTarget",{configurable:!0,get(){return u}}),Object.defineProperty(l,"data",{configurable:!0,get(){return n}});const P=i.call(x,l,l.___td);r&&tt(u,p,k,e,S),P===!1&&(l.preventDefault(),l.stopPropagation())};S.guid=i.guid=i.guid||s.guid++,ke(u,p,k,e,S)})}),this):this}o.on=Ee;function $e(t,e,n,i){return this.on(t,e,n,i,!0)}o.one=$e;const Se=/\r?\n/g;function _e(t,e){return`&${encodeURIComponent(t)}=${encodeURIComponent(e.replace(Se,`\r
`))}`}const Ae=/file|reset|submit|button|image/i,Dt=/radio|checkbox/i;o.serialize=function(){let t="";return this.each((e,n)=>{y(n.elements||[n],(i,r)=>{if(r.disabled||!r.name||r.tagName==="FIELDSET"||Ae.test(r.type)||Dt.test(r.type)&&!r.checked)return;const c=Rt(r);if(!$(c)){const a=G(c)?c:[c];y(a,(d,k)=>{t+=_e(r.name,k)})}})}),t.slice(1)};function Re(t){var e=window.getComputedStyle(t);return e.display==="none"||parseInt(e.height)===0}function Ne(){return this.filter(function(t,e){return!Re(e)})}function Le(t){return t instanceof Element?"element":Object.prototype.toString.call(t).replace(/\[object\s(.+)\]/,"$1").toLowerCase()}const Oe=`.print-container{font-size:9pt;line-height:18pt;letter-spacing:1px;width:210mm;margin:0 auto;box-sizing:border-box;background:#fff!important;color:#000!important}.print-container table{line-height:1.5}.break-page{box-shadow:0 0 8px 4px #ccc;padding:50px;margin-top:20px;page-break-after:always;position:relative;min-height:294mm;box-sizing:border-box}.break-page:first-child{margin-top:30px}.break-page:last-child{page-break-after:unset;margin-bottom:20px}table.break-table{border-collapse:collapse;border:1px solid black}table.break-table td,table.break-table th{border:1px solid black}@media print{.print-container{width:100%!important}.print-container .break-page{box-shadow:none;margin:0;max-height:294mm}.break-page:first-child{margin-top:0}img{max-height:902px}@page{size:a4;padding:0;margin:0}}
`;function He(t){i(Oe);const e=function(){let h=document.createElement("div");h.id="mm",h.style.width="1mm",document.querySelector("body").appendChild(h);let g=document.getElementById("mm").getBoundingClientRect();return s("#mm").remove(),g.width}();let n=500;s("body").__proto__.notHidden=Ne;function i(f){if(typeof f!="string"){console.error("print style is invalid");return}if(document.getElementById("print-style"))return;console.log("create style");const h=document.createElement("style");h.id="print-style",h.setAttribute("type","text/css"),h.innerHTML=f,document.head.append(h)}function r(){const f=Le(t);let h;["string","element","htmlcollection"].includes(f)&&(h=s(t)),h!=null&&h.length&&(h.addClass("print-container"),h.children().notHidden().each(function(){s(this).addClass("break-page"),s(this).children().notHidden().each(function(u,S){S.tagName.toLowerCase()==="table"?s(this).addClass("break-table"):s(this).addClass("need-break")})})),console.log("start paging"),s("table.break-table").children("thead").addClass("need-break thead_break"),s("table.break-table tbody tr").addClass("need-break table_break");let g=c();for(;g.length;)g=c(a(g));console.log("end paging")}function c(f){return f?f.nextAll(".break-page").notHidden().first():s(".break-page").notHidden().first()}function a(f,h=0){if(--n<=0)throw new Error("Recursion error when breaking page");if(f.outerHeight()<=294*e+5||++h>50)return f;const g=f.offset().top,u=parseInt(f.css("paddingBottom"));let S=!1,l=null;return f.find(".need-break").notHidden().each(function(x,P){if(s(this).offset().top+s(this).outerHeight()-g+parseInt(s(this).css("marginBottom"))<=294*e-u)return!0;S=!0;let T=f.attr("class");return f.hasClass("new-break-page")||(T+=" new-break-page"),l=s(`<div class="${T}" style="display:block"></div>`),s(this).hasClass("table_break")?p.call(this,l,x):s(this).hasClass("thead_break")?k.call(this,l):d.call(this,l),f.after(l),!1}),S?a(l,h):f}function d(f){!f||!this||(f.append(s(this).clone()),f.append(s(this).nextAll().clone()),s(this).nextAll().remove(),s(this).remove())}function k(f){!f||!this||(f.append(s(this).parents("table").clone()),f.append(s(this).parents("table").nextAll().clone()),s(this).parents("table").nextAll().remove(),s(this).parents("table").remove())}function p(f,h){var g=s(`<table class="${s(this).parents("table").attr("class")}"></table>`);g.append("<tbody></tbody>");var u=s(this);let S=h>1;if(h==1&&(S=s(this).find(".need-break").notHidden().not(".thead_break").length!==0),S){g.prepend(u.parents("table").children("thead").clone());let l=s(this).prevAll("tr"),x=[],P=[];for(let m=l.length-1;m>=0;m--){const V=l[m],U=m===l.length-1,_=s(V).find("td");if(U||(x=x.map(A=>A-1>0?A-1:0)),U){let A=0;for(let H=0,F=_.length;H<F;H++)A+=+s(_[H]).attr("colspan")||1;x=new Array(A).fill(0)}for(let A=0,H=_.length;A<H;A++){const F=_[A],Y=+s(F).attr("rowspan")||1,W=+s(F).attr("colspan")||1;if(W>0){let q=x.findIndex(C=>C<1);for(let C=0;C<W;C++)x[q+C]=(x[q+C]||0)+Y;if(Y>1){P[q]=[m,A,Y,W];for(let C=1;C<W;C++)P[q+C]=void 0}}}}let T=x.map(m=>m>1?"N":0);u.find("td").each(function(m){const V=+s(this).attr("colspan")||1,U=T.findIndex(_=>_===0);for(let _=0;_<V;_++)T[U+_]=m+1});const Ft={};for(let m=0;m<P.length;m++){if(!P[m])continue;const[V,U,_,A]=P[m]||[],H=_-V-1;if(H<=0)continue;const F=s(l[V]).find("td")[U];s(F).attr("rowspan",_-H);const Y=s(F).clone().attr("rowspan",H),W="splitTd"+m;Ft[W]=Y;let q=T.findIndex(C=>C==="N");if(q!==-1)for(let C=0;C<A;C++)T[q+C]=W}const gt=u.clone().empty();[...new Set(T)].forEach(m=>{typeof m=="string"?gt.append(Ft[m]):gt.append(u.find("td").eq(m-1).clone())});const ve=u.prev("tr").length===0;g.children("tbody").append(gt.clone()),g.children("tbody").append(u.nextAll().clone()),f.append(g),f.append(u.parents("table").nextAll().clone()),u.nextAll().remove(),u.parents("table").nextAll().remove(),ve?u.parents("table").remove():u.remove()}else{u.nextAll().length?(g.prepend(u.parents("table").children("thead").clone()),g.children("tbody").append(u.nextAll().clone()),u.nextAll().remove(),f.append(g),f.append(u.parents("table").nextAll().clone()),u.parents("table").nextAll().remove()):(f.append(u.parents("table").nextAll().clone()),u.parents("table").nextAll().remove());let l=s(`<div style="height:${294*e-100}px;overflow:hidden;"></div>`);u.parents(".break-page").append(l),l.append(u.parents("table"))}}return{execPaging:r}}return He});
